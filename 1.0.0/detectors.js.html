<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: detectors.js</title>
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-fe2.css">
</head>
<body>

<div id="wrap">

    <div class="header">

        <div class="container-fluid">
            <h3><a href="index.html">API Documentation</a> <small>FE개발팀</small></h3>
        </div>

    </div>

    <div class="body">
        <div id="navigation" class="navigation"><h3>Samples</h3><ul class="list samples"><li class="item"><a href="tutorial-tutorial.html">tutorial</a></li></ul><h3>Classes</h3><ul class="list classes"><li class="item" id="ne.component.AppLoader"><span class="title"><span class="p-item">ne.component.</span><a href="ne.component.AppLoader.html">AppLoader</a></span><span class="icon blue static">static</span><ul class="sublist members ne.component.AppLoader"><span class="subtitle">Members</span><li><a href="ne.component.AppLoader.html#defaults">defaults</a></li><li><a href="ne.component.AppLoader.html#detector">detector</a></li><li><a href="ne.component.AppLoader.html#os">os</a></li></ul><ul class="sublist division ne.component.AppLoader"><li></li></ul><ul class="sublist methods ne.component.AppLoader"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.html#exec">exec</a></li><li><a href="ne.component.AppLoader.html#getOS">getOS</a></li><li><a href="ne.component.AppLoader.html#init">init</a></li><li><a href="ne.component.AppLoader.html#isIntentLess">isIntentLess</a></li><li><a href="ne.component.AppLoader.html#runDetector">runDetector</a></li><li><a href="ne.component.AppLoader.html#setDetector">setDetector</a></li></ul></li><li class="item" id="ne.component.AppLoader.agentDetector"><span class="title"><span class="p-item">ne.component.AppLoader.</span><a href="ne.component.AppLoader.agentDetector.html">agentDetector</a></span><span class="icon blue static">static</span><ul class="sublist members ne.component.AppLoader.agentDetector"><span class="subtitle">Members</span><li><a href="ne.component.AppLoader.agentDetector.html#mobileRegText">mobileRegText</a></li><li><a href="ne.component.AppLoader.agentDetector.html#ua">ua</a></li></ul><ul class="sublist division ne.component.AppLoader.agentDetector"><li></li></ul><ul class="sublist methods ne.component.AppLoader.agentDetector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.agentDetector.html#convert">convert</a></li><li><a href="ne.component.AppLoader.agentDetector.html#getOS">getOS</a></li><li><a href="ne.component.AppLoader.agentDetector.html#isAndroid">isAndroid</a></li><li><a href="ne.component.AppLoader.agentDetector.html#isIOS">isIOS</a></li><li><a href="ne.component.AppLoader.agentDetector.html#userAgent">userAgent</a></li><li><a href="ne.component.AppLoader.agentDetector.html#version">version</a></li></ul></li></ul><h3>Namespaces</h3><ul class="list namespaces"><li class="item" id="ne.component.AppLoader.Detector"><span class="icon blue static">static</span><span class="title"><a href="ne.component.AppLoader.Detector.html">Detector</a></span><ul class="sublist members ne.component.AppLoader.Detector"><span class="subtitle">Members</span><li><a href="ne.component.AppLoader.Detector.html#.TIMEOUT">TIMEOUT</a></li></ul><ul class="sublist division ne.component.AppLoader.Detector"><li></li></ul><ul class="sublist methods ne.component.AppLoader.Detector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.Detector.html#.deferCallback">deferCallback</a></li><li><a href="ne.component.AppLoader.Detector.html#.getIframeMadeById">getIframeMadeById</a></li><li><a href="ne.component.AppLoader.Detector.html#.isPageVisibility">isPageVisibility</a></li><li><a href="ne.component.AppLoader.Detector.html#.runAppWithIframe">runAppWithIframe</a></li></ul></li><li class="item" id="ne.component.AppLoader.Detector.androidIntendDetector"><span class="icon blue static">static</span><span class="title"><a href="ne.component.AppLoader.Detector.androidIntendDetector.html">androidIntendDetector</a></span><ul class="sublist members ne.component.AppLoader.Detector.androidIntendDetector"><span class="subtitle">Members</span><li><a href="ne.component.AppLoader.Detector.androidIntendDetector.html#.type">type</a></li></ul><ul class="sublist division ne.component.AppLoader.Detector.androidIntendDetector"><li></li></ul><ul class="sublist methods ne.component.AppLoader.Detector.androidIntendDetector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.Detector.androidIntendDetector.html#.run">run</a></li></ul></li><li class="item" id="ne.component.AppLoader.Detector.androidSchemeDetector"><span class="icon blue static">static</span><span class="title"><a href="ne.component.AppLoader.Detector.androidSchemeDetector.html">androidSchemeDetector</a></span><ul class="sublist members ne.component.AppLoader.Detector.androidSchemeDetector"><span class="subtitle">Members</span><li><a href="ne.component.AppLoader.Detector.androidSchemeDetector.html#.type">type</a></li></ul><ul class="sublist division ne.component.AppLoader.Detector.androidSchemeDetector"><li></li></ul><ul class="sublist methods ne.component.AppLoader.Detector.androidSchemeDetector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.Detector.androidSchemeDetector.html#.run">run</a></li></ul></li><li class="item" id="ne.component.AppLoader.etcDetector"><span class="icon blue static">static</span><span class="title"><a href="ne.component.AppLoader.etcDetector.html">etcDetector</a></span><ul class="sublist members ne.component.AppLoader.etcDetector"><span class="subtitle">Members</span><li><a href="ne.component.AppLoader.etcDetector.html#.type">type</a></li></ul><ul class="sublist division ne.component.AppLoader.etcDetector"><li></li></ul><ul class="sublist methods ne.component.AppLoader.etcDetector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.etcDetector.html#.run">run</a></li></ul></li><li class="item" id="ne.component.AppLoader.iOSDetector"><span class="icon blue static">static</span><span class="title"><a href="ne.component.AppLoader.iOSDetector.html">iOSDetector</a></span><ul class="sublist members ne.component.AppLoader.iOSDetector"><span class="subtitle">Members</span><li><a href="ne.component.AppLoader.iOSDetector.html#.type">type</a></li></ul><ul class="sublist division ne.component.AppLoader.iOSDetector"><li></li></ul><ul class="sublist methods ne.component.AppLoader.iOSDetector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.iOSDetector.html#.bindPagehideEvent">bindPagehideEvent</a></li><li><a href="ne.component.AppLoader.iOSDetector.html#.bindVisibilityChangeEvent">bindVisibilityChangeEvent</a></li><li><a href="ne.component.AppLoader.iOSDetector.html#.moveTo">moveTo</a></li></ul></li><li class="item" id="ne.component.AppLoader.iOSDetector.iosOlderDetector"><span class="icon blue static">static</span><span class="title"><a href="ne.component.AppLoader.iOSDetector.iosOlderDetector.html">iosOlderDetector</a></span><ul class="sublist methods ne.component.AppLoader.iOSDetector.iosOlderDetector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.iOSDetector.iosOlderDetector.html#.run">run</a></li></ul></li><li class="item" id="ne.component.AppLoader.iOSDetector.iosRecentDetector"><span class="icon blue static">static</span><span class="title"><a href="ne.component.AppLoader.iOSDetector.iosRecentDetector.html">iosRecentDetector</a></span><ul class="sublist methods ne.component.AppLoader.iOSDetector.iosRecentDetector"><span class="subtitle">Methods</span><li><a href="ne.component.AppLoader.iOSDetector.iosRecentDetector.html#.run">run</a></li></ul></li></ul></div>
        <div id="main" class="main">



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileovrview 모바일 앱을 호출하는 객체. 들어오는 값및 ua를 통해 추출한 환경 값에 따라 다른 detector를 설정하여, 앱 호출 역할을 위임한다.
 * @dependency code-snippet.js, appLoader.js
 * @author FE개발팀
 */
/**
 * @namespace ne.component.AppLoader.Detector
 */
ne.component.AppLoader.Detector = {
    /**
     * for timer
     */
    TIMEOUT: {
        IOS_SHORT: 1000,
        IOS_LONG: 1000 * 2,
        ANDROID: 100 * 3,
        INTERVAL: 100
    },
    
    /**
     * iframe을 통한 앱호출
     * @param {string} urlScheme iframe url
     */
    runAppWithIframe: function (urlScheme) {
        var self = this,
            iframe;
        setTimeout(function () {
            iframe = self.getIframeMadeById('supportFrame');
            iframe.src = urlScheme;
        }, this.TIMEOUT.INTERVAL);
    },

    /**
     * iframe 생성
     * @param {string} id iframe ID
     * @returns {HTMLElement}
     */
    getIframeMadeById: function (id) {
        var iframe = document.createElement('iframe');
        ne.util.extend(iframe, {
            id: id,
            frameborder: '0',
            width: '0',
            height: '0'
        });
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
        return iframe;
    },

    /**
     * callback함수를 time에 따라 지연실행
     * @param {string} time 지연시간
     * @param {string} url 호출 url
     * @param {function} callback 실행함수
     * @returns {number}
     */
    deferCallback: function (url, callback, time) {
        var clickedAt = new Date().getTime(),
            now,
            isPV = this.isPageVisibility(),
            self = this;

        return setTimeout(function () {
            now = new Date().getTime();
            if (isPV &amp;&amp; now - clickedAt &lt; time + self.TIMEOUT.INTERVAL) {
                callback(url);
            }
        }, time);
    },

    /**
     * check a webpage is visible or in focus
     * @returns {boolean}
     */
    isPageVisibility: function () {
        if (ne.util.isExisty(document.hidden)) {
            return !document.hidden;
        }
        if (ne.util.isExisty(document.webkitHidden)) {
            return !document.webkitHidden;
        }
        return true;
    }
};

/****************
 * Android series
 ****************/

/**
 * 안드로이드 intent지원 불가 detector
 * @namespace ne.component.AppLoader.Detector.androidSchemeDetector
 */
ne.component.AppLoader.Detector.androidSchemeDetector = ne.util.extend({
    /**
     * detector type
     * @memberof ne.component.AppLoader.Detector.androidSchemeDetector
     */
    type: 'scheme',

    /**
     * detector 실행
     * @param {object} context
     * @memberof ne.component.AppLoader.Detector.androidSchemeDetector
     */
    run: function(context) {
        var storeURL = context.storeURL;
        this.deferCallback(storeURL, context.notFoundCallback, this.TIMEOUT.ANDROID);
        this.runAppWithIframe(context.urlScheme);
    }
}, ne.component.AppLoader.Detector);


/**
 * 안드로이드 intent지원 detector
 * @namespace ne.component.AppLoader.Detector.androidIntendDetector
 */
ne.component.AppLoader.Detector.androidIntendDetector = ne.util.extend({
    /**
     * detector type
     * @memberof ne.component.AppLoader.Detector.androidIntendDetector
     */
    type: 'intend',

    /**
     * detector 실행
     * @param {object} context
     * @memberof ne.component.AppLoader.Detector.androidIntendDetector
     */
    run: function(context) {
        setTimeout(function () {
            top.location.href = context.intentURI;
        }, this.TIMEOUT.INTERVAL);
    }
}, ne.component.AppLoader.Detector);

/**
 * iosDetector 공통기능
 * @namespace ne.component.AppLoader.iOSDetector
 */
ne.component.AppLoader.iOSDetector = ne.util.extend({
    /**
     * detector type
     * @memberof ne.component.AppLoader.iOSDetector
     */
    type: 'ios',

    /**
     * 기본 앱페이지 이동함수
     * @param storeURL
     * @memberof ne.component.AppLoader.iOSDetector
     */
    moveTo: function(storeURL) {
        window.location.href = storeURL;
    },

    /**
     * visiblitychange  이벤트 등록
     * @memberof ne.component.AppLoader.iOSDetector
     */
    bindVisibilityChangeEvent: function() {
        var self = this;
        document.addEventListener('visibilitychange', function clear() {
            if (self.isPageVisibility()) {
                clearTimeout(self.tid);
                document.removeEventListener('visibilitychange', clear);
            }
        });
    },

    /**
     *  pagehide 이벤트 등록
     *  @memberof ne.component.AppLoader.iOSDetector
     */
    bindPagehideEvent: function() {
        var self = this;
        window.addEventListener('pagehide', function clear() {
            if (self.isPageVisibility()) {
                clearTimeout(self.tid);
                window.removeEventListener('pagehide', clear);
            }
        });
    }
}, ne.component.AppLoader.Detector);

/****************
 * iOS series
 ****************/

/**
 * ios 구버전 detector
 * @namespace ne.component.AppLoader.iOSDetector.iosOlderDetector
 */
ne.component.AppLoader.iOSDetector.iosOlderDetector = ne.util.extend({
    /**
     * detector 실행
     * @param {object} context
     * @memberof ne.component.AppLoader.iOSDetector.iosOlderDetector
     */
    run: function(context) {
        var storeURL = context.storeURL,
            callback = context.notFoundCallback || this.moveTo;
        this.tid = this.deferCallback(storeURL, callback, this.TIMEOUT.IOS_LONG);
        this.bindPagehideEvent();
        this.runAppWithIframe(context.urlScheme);
    }
}, ne.component.AppLoader.iOSDetector);

/**
 * ios 구버전 detector
 * @namespace ne.component.AppLoader.iOSDetector.iosRecentDetector
 */
ne.component.AppLoader.iOSDetector.iosRecentDetector = ne.util.extend({
    /**
     * detector 실행
     * @param {object} context
     * @memberof ne.component.AppLoader.iOSDetector.iosRecentDetector
     */
    run: function(context) {
        var storeURL = context.storeURL,
            callback = context.notFoundCallback || this.moveTo;
        if (this.moveTo === callback) {
            this.tid = this.deferCallback(storeURL, callback, this.TIMEOUT.IOS_SHORT);
        } else {
            this.tid = this.deferCallback(storeURL, callback, this.TIMEOUT.IOS_LONG);
        }
        this.bindVisibilityChangeEvent();
        this.runAppWithIframe(context.urlScheme);
    }
}, ne.component.AppLoader.iOSDetector);

/****************
 * ETC
 ****************/

/**
 * 기타 미지원 환경
 * @namespace ne.component.AppLoader.etcDetector
 */
ne.component.AppLoader.Detector.etcDetector = {
    /**
     * @memberof ne.component.AppLoader.etcDetector
     */
    type: 'etc',
    /**
     * @memberof ne.component.AppLoader.etcDetector
     */
    run: function() {
    }
};
</code></pre>
        </article>
    </section>



</div>
        <div class="clearfix"></div>
    </div>

</div>
<script>
(function() {
// 영역 height 설정
var height = (window.innerHeight || document.documentElement.clientHeight || document.getElementByTagName('body')[0].clientHeight) - 50;
var navigation = document.getElementById('navigation');
var main = document.getElementById('main');
navigation.style.height = height + 'px';
main.style.height = height + 'px';

// IE 7,8을 위한 getElementsByClassName 구현
var getElementsByClassName = function(className, parentElement) {
	if(document.getElementsByClassName) {
		return (parentElement || document).getElementsByClassName(className);
	}

    var regEx = new RegExp('(^| )'+className+'( |$)');
	var nodes = new Array();
    var elements = (parentElement || document.body).getElementsByTagName("*");
    for(var i = 0, len = elements.length; i < len ; i++) {
        if(regEx.test(elements[i].className)) {
			nodes.push(elements[i]);
		}
	}
	elements = null;
    return nodes;
}

// url 파싱후 해당 카테고리만 display:block 처리
var url = location.href;
var path = url.lastIndexOf('/');
var fileName = url.substring(path+1);
var fullName = fileName.split('.');
fullName.length -= 1;
fullName = fullName.join('.');
fullName = fullName.split('-');
fullName = fullName[fullName.length - 1];
var lnbList = getElementsByClassName(fullName);
if(lnbList.length && lnbList.length > 0) {
    for(var i = 0, len = lnbList.length; i < len; i++) {
        lnbList[i].className += ' selected';
    }
}

var title = document.getElementById(fullName);
if(title) {
    title.className += ' selected';
    title.innerHTML = '<span class="arrow">▶</span>' + title.innerHTML;

    var static = getElementsByClassName('static', title);
    if(static) {
        static[0].className += ' selected';
    }
}
})();
</script>
<script type="text/javascript" src="scripts/prettify/prettify.js"></script>
<script type="text/javascript" src="scripts/prettify/lang-css.js"></script>
<script type="text/javascript">prettyPrint();</script>
<script type="text/javascript" src="scripts/linenumber.js"></script>
</body>
</html>
